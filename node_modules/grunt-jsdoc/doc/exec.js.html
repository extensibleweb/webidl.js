<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: lib/exec.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: lib/exec.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
 * Provides utility methods to execute a command
 * @module exec
 */
module.exports = {

	/**
	 * Build and execute a child process using the spawn function
	 * @param {Object} grunt - the grunt context
	 * @param {String} script - the script to run
	 * @param {Array} sources - the list of sources files
	 * @param {Object} options - the list of cli flags
	 * @return {ChildProcess} from the spawn
	 */
	buildSpawned : function(grunt, script, sources, options){
		'use strict';
	
		var util = require('util'),
			isWin = process.platform === 'win32',
			cmd = (isWin) ? 'cmd' : script,
			args = (isWin) ? ['/c', script] : [],
			spawn = require('child_process').spawn;

		// Compute JSDoc options
		for (var optionName in options) {
			var option = options[optionName];
			grunt.log.debug("Reading option: " + optionName);
			args.push('--' + optionName);
			if (options.hasOwnProperty(optionName) && typeof(option) === 'string') {
				grunt.log.debug("                > " + option);
				args.push(option);
			}
		}

		if(!util.isArray(sources)){
			sources = [sources];
		}
		args.push.apply(args, sources);

		grunt.log.debug("Running : "+ cmd + " " + args.join(' '));

		return spawn(cmd, args);
	},

	/**
	 * Lookup file or path into node modules
	 * @param {Object} grunt - the grunt context
	 * @param {String} base - the file or path to lookup 
	 * @param {String|Array} extPath - additionnal pathes to lookup
	 * @returns {String} the first matching resolved path
	 */
	lookup : function(grunt, base, extPath){
		'use strict';

		var paths		= [],
			fs			= require('fs'),
			path		= require('path'),
			nodePath	= process.env.NODE_PATH || '',
			_			= grunt.util._;

		//check first the base path into the cwd
		paths.push(base);

		if(!extPath){
			extPath = [];
		} else if(typeof extPaths === 'string'){
			extPath = [extPath];
		}
		
		grunt.log.debug('nodePath' + nodePath);
		_.map(extPath.concat(nodePath.split(path.delimiter)), function(p){
			if(!/\/$/.test(p)){
				p += '/';
			}
			paths.push(p);
			paths.push(p + base);
		});

		for(var i in paths){
			grunt.log.debug('look up ' + base + ' at ' + paths[i]);
			if(fs.existsSync(paths[i]) && fs.statSync(paths[i]).isFile() === true ){
				//get the absolute path
				return path.resolve(paths[i]);
			}
		}

		return;
	}
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="module-exec.html">exec</a></li><li><a href="jsdoc-plugin.html">tasks/jsdoc-plugin</a></li></ul></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.0-dev</a> on Sat May 25 2013 15:54:50 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
</body>
</html>
